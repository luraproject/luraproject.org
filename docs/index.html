<!doctype html><html class="bg-white antialiased"><head><meta http-equiv=content-type content="text/html" charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Documentation - Lura Project Open Source API Gateway</title><link rel="shortcut icon" href=https://luraproject.org/images/favicon.png type=image/png><meta name=description content="Lura Project - An Open Source Api Gateway Framework"><meta name=keywords content="api gateway,open source,linux foundation"><meta name=referrer content="no-referrer-when-downgrade"><meta name=viewport content="width=device-width"><meta property="og:title" content="Documentation - Lura Project Open Source API Gateway"><meta property="og:description" content="Library Usage Lura is presented as a go library that you can include in your own go application to build a powerful proxy or API gateway. In order to get you started several examples of implementations are included in the examples folder.
Of course you will need golang installed in your system to compile the code.
A ready to use example:
package main import ( &#34;flag&#34; &#34;log&#34; &#34;os&#34; &#34;github.com/luraproject/lura/config&#34; &#34;github.com/luraproject/lura/logging&#34; &#34;github."><meta property="og:type" content="article"><meta property="og:url" content="https://luraproject.org/docs/"><meta property="og:image" content="https://luraproject.org/images/share-image.png"><meta property="article:section" content><meta property="article:published_time" content="2019-03-26T08:47:11+01:00"><meta property="article:modified_time" content="2019-03-26T08:47:11+01:00"><meta property="og:site_name" content="The Lura Project"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://luraproject.org/images/share-image.png"><meta name=twitter:title content="Documentation - Lura Project Open Source API Gateway"><meta name=twitter:description content="Library Usage Lura is presented as a go library that you can include in your own go application to build a powerful proxy or API gateway. In order to get you started several examples of implementations are included in the examples folder.
Of course you will need golang installed in your system to compile the code.
A ready to use example:
package main import ( &#34;flag&#34; &#34;log&#34; &#34;os&#34; &#34;github.com/luraproject/lura/config&#34; &#34;github.com/luraproject/lura/logging&#34; &#34;github."><meta itemprop=name content="Documentation - Lura Project Open Source API Gateway"><meta itemprop=description content="Library Usage Lura is presented as a go library that you can include in your own go application to build a powerful proxy or API gateway. In order to get you started several examples of implementations are included in the examples folder.
Of course you will need golang installed in your system to compile the code.
A ready to use example:
package main import ( &#34;flag&#34; &#34;log&#34; &#34;os&#34; &#34;github.com/luraproject/lura/config&#34; &#34;github.com/luraproject/lura/logging&#34; &#34;github."><meta itemprop=datePublished content="2019-03-26T08:47:11+01:00"><meta itemprop=dateModified content="2019-03-26T08:47:11+01:00"><meta itemprop=wordCount content="879"><meta itemprop=image content="https://luraproject.org/images/share-image.png"><meta itemprop=keywords content><link href=https://luraproject.org/css/main.d0ecdfeb330c16e58dcc2044d044afb57549098bf63801d79c89076826b05cc6.css rel=stylesheet></head><body><header><div class=bg-denim-100><div class="w-full max-w-screen-xl relative mx-auto p-6 flex items-stretch"><div class=mr-24><a href=/><img class="block mx-auto" src=/images/lura-logo-header.svg width=150 alt="The Lura Project"></a></div><div class="flex-1 flex items-center space-x-6 text-denim-600 font-bold text-lg"><a class="block text-denim-800 border-b-2" href=https://luraproject.org/docs/>Docs</a>
<a class=block href=https://luraproject.org/community/>Community</a>
<a class=block href=https://github.com/luraproject/lura/releases>Download<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline -mt-4" fill="none" viewBox="0 0 24 24" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6A2 2 0 004 8v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg></a>
<a class=block href=https://github.com/luraproject/lura>Github repo<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline -mt-4" fill="none" viewBox="0 0 24 24" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6A2 2 0 004 8v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg></a></div></div></div></header><main id=main class="w-full max-w-screen-xl mx-auto"><div class=px-6><div id=content-wrapper class="min-h-screen w-full sm:max-w-2xl max-w-3xl mx-auto"><div id=content><div class=flex><div class="pb-16 w-full pt-12"><div class="homepage-content prose w-full max-w-3xl mx-auto mb-6"><h2 id=library-usage>Library Usage</h2><p>Lura is presented as a <strong>go library</strong> that you can include in your own go application to build a powerful proxy or API gateway. In order to get you started several examples of implementations are included in the <code>examples</code> folder.</p><p>Of course you will need <a href=https://golang.org/doc/install>golang installed</a> in your system to compile the code.</p><p>A ready to use example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go>    <span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>

    <span style=color:#f92672>import</span> (
        <span style=color:#e6db74>&#34;flag&#34;</span>
        <span style=color:#e6db74>&#34;log&#34;</span>
        <span style=color:#e6db74>&#34;os&#34;</span>

        <span style=color:#e6db74>&#34;github.com/luraproject/lura/config&#34;</span>
        <span style=color:#e6db74>&#34;github.com/luraproject/lura/logging&#34;</span>
        <span style=color:#e6db74>&#34;github.com/luraproject/lura/proxy&#34;</span>
        <span style=color:#e6db74>&#34;github.com/luraproject/lura/router/gin&#34;</span>
    )

    <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
        <span style=color:#a6e22e>port</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>Int</span>(<span style=color:#e6db74>&#34;p&#34;</span>, <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#34;Port of the service&#34;</span>)
        <span style=color:#a6e22e>logLevel</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>String</span>(<span style=color:#e6db74>&#34;l&#34;</span>, <span style=color:#e6db74>&#34;ERROR&#34;</span>, <span style=color:#e6db74>&#34;Logging level&#34;</span>)
        <span style=color:#a6e22e>debug</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>Bool</span>(<span style=color:#e6db74>&#34;d&#34;</span>, <span style=color:#66d9ef>false</span>, <span style=color:#e6db74>&#34;Enable the debug&#34;</span>)
        <span style=color:#a6e22e>configFile</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>String</span>(<span style=color:#e6db74>&#34;c&#34;</span>, <span style=color:#e6db74>&#34;/etc/lura/lura.json&#34;</span>, <span style=color:#e6db74>&#34;Path to the configuration filename&#34;</span>)
        <span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>Parse</span>()

        <span style=color:#a6e22e>parser</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>NewParser</span>()
        <span style=color:#a6e22e>serviceConfig</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>parser</span>.<span style=color:#a6e22e>Parse</span>(<span style=color:#f92672>*</span><span style=color:#a6e22e>configFile</span>)
        <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
            <span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatal</span>(<span style=color:#e6db74>&#34;ERROR:&#34;</span>, <span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>Error</span>())
        }
        <span style=color:#a6e22e>serviceConfig</span>.<span style=color:#a6e22e>Debug</span> = <span style=color:#a6e22e>serviceConfig</span>.<span style=color:#a6e22e>Debug</span> <span style=color:#f92672>||</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>debug</span>
        <span style=color:#66d9ef>if</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>port</span> <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span> {
            <span style=color:#a6e22e>serviceConfig</span>.<span style=color:#a6e22e>Port</span> = <span style=color:#f92672>*</span><span style=color:#a6e22e>port</span>
        }

        <span style=color:#a6e22e>logger</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>logging</span>.<span style=color:#a6e22e>NewLogger</span>(<span style=color:#f92672>*</span><span style=color:#a6e22e>logLevel</span>, <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Stdout</span>, <span style=color:#e6db74>&#34;[LURA]&#34;</span>)

        <span style=color:#a6e22e>routerFactory</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>gin</span>.<span style=color:#a6e22e>DefaultFactory</span>(<span style=color:#a6e22e>proxy</span>.<span style=color:#a6e22e>DefaultFactory</span>(<span style=color:#a6e22e>logger</span>), <span style=color:#a6e22e>logger</span>)

        <span style=color:#a6e22e>routerFactory</span>.<span style=color:#a6e22e>New</span>().<span style=color:#a6e22e>Run</span>(<span style=color:#a6e22e>serviceConfig</span>)
    }
</code></pre></div><h1 id=overview>Overview</h1><h2 id=the-lura-rules>The Lura rules</h2><ul><li><a href=http://www.reactivemanifesto.org/>Reactive is key</a></li><li>Reactive is key (yes, it is very very important)</li><li>Failing fast is better than succeeding slow (say it one more time!)</li><li>The simpler, the better</li><li>Everything is plugglable</li><li>Each request must be processed in its own request-scoped context</li></ul><h2 id=the-big-picture>The big picture</h2><p>Lura is composed of a set of packages designed as building blocks for creating pipes and processors between an exposed endpoint and one or several API resources served by your backends.</p><p>The most important packages are:</p><ol><li>the <code>config</code> package defines the service.</li><li>the <code>router</code> package sets up the endpoints exposed to the clients.</li><li>the <code>proxy</code> package adds the required middlewares and components for further processing of the requests to send and the received responses sent by the backends, and also to manage the connections against those backends.</li></ol><p>The rest of the packages of the framework contain some helpers and adapters for complementary tasks, like encoding, logging or service discovery.</p><h2 id=the-config-package>The <code>config</code> package</h2><p>The <code>config</code> package contains the structs required for the service description.</p><p>The <code>ServiceConfig</code> struct defines the entire service. It should be initialized before using it in order to be sure that all parameters have been normalized and default values have been applied.</p><p>The <code>config</code> package also defines an interface for a file config parser and a parser based on the <a href=https://github.com/spf13/viper>viper</a> library.</p><h2 id=the-router-package>The <code>router</code> package</h2><p>The <code>router</code> package contains an interface and several implementations for the Lura router layer using the <code>mux</code> router from the <code>net/http</code> and the <code>httprouter</code> wrapped in the <code>gin</code> framework.</p><p>The router layer is responsible for setting up the HTTP(S) services, binding the endpoints defined at the <code>ServiceConfig</code> struct and transforming the http request into proxy requests before delegating the task to the inner layer (proxy). Once the internal proxy layer returns a proxy response, the router layer converts it into a proper HTTP response and sends it to the user.</p><p>This layer can be easily extended in order to use any HTTP router, framework or middleware of your choice. Adding transport layer adapters for other protocols (Thrift, gRPC, AMQP, NATS, etc) is in the roadmap. As always, PRs are welcome!</p><h2 id=the-proxy-package>The <code>proxy</code> package</h2><p>The <code>proxy</code> package is where the most part of the Lura components and features are placed. It defines two important interfaces, designed to be stacked:</p><ul><li><em>Proxy</em> is a function that converts a given context and request into a response.</li><li><em>Middleware</em> is a function that accepts one or more proxies and returns a single proxy wrapping them.</li></ul><p>This layer transforms the request received from the outter layer (router) into a single or several requests to your backend services, processes the responses and returns a single response.</p><p>Middlewares generates custom proxies that are chained depending on the workflow defined in the configuration until each possible branch ends in a transport-related proxy. Every one of these generated proxies is able to transform the input or even clone it several times and pass it or them to the next element in the chain. Finally, they can also modify the received response or responses adding all kinds of features to the generated pipe.</p><p>Lura provides a default implementation of the proxy stack factory.</p><h3 id=middlewares-available>Middlewares available</h3><ul><li>The <code>balancing</code> middleware uses some type of strategy for selecting a backend host to query.</li><li>The <code>concurrent</code> middleware improves the QoS by sending several concurrent requests to the next step of the chain and returning the first succesful response using a timeout for canceling the generated workload.</li><li>The <code>logging</code> middleware logs the received request and response and also the duration of the segment execution.</li><li>The <code>merging</code> middleware is a fork-and-join middleware. It is intended to split the process of the request into several concurrent processes, each one against a different backend, and to merge all the received responses from those created pipes into a single one. It applies a timeout, as the <code>concurrent</code> one does.</li><li>The <code>http</code> middleware completes the received proxy request by replacing the parameters extracted from the user request in the defined <code>URLPattern</code>.</li></ul><h3 id=proxies-available>Proxies available</h3><ul><li>The <code>http</code> proxy translates a proxy request into an HTTP one, sends it to the backend API using a <code>HTTPClientFactory</code>, decodes the returned HTTP response with a <code>Decoder</code>, manipulates the response data with an <code>EntityFormatter</code> and returns it to the caller.</li></ul><h3 id=other-components-of-the-proxy-package>Other components of the <code>proxy</code> package</h3><p>The <code>proxy</code> package also defines the <code>EntityFormatter</code>, the block responsible for enabling a powerful and fast response manipulation.</p></div></div></div></div></div></div></main><footer id=footer class="w-full max-w-screen-xl mx-auto mb-6"><div class=px-6><div class="w-full sm:max-w-2xl max-w-3xl mx-auto"><div class="prose copyright">Copyright © 2021 Lura Project a Series of LF Projects, LLC<br><small>For web site terms of use, trademark policy and other project policies please see <a href=https://lfprojects.org>https://lfprojects.org</a></small></div></div></div></footer></body></html>